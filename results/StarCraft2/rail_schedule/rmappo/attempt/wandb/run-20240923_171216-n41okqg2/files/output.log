observation_space [Box(9,), Box(9,), Box(9,)]
share_observation_space [Box(27,), Box(27,), Box(27,)]
obs_space:  [Box(9,), Box(9,), Box(9,)]
share_obs_space:  [Box(27,), Box(27,), Box(27,)]
act_space:  Discrete(3)

 Scenario rail_schedule Algo rmappo Exp attempt updates 0/520 episodes, total num timesteps 1920/1000000.0, FPS 1343.

average episode rewards is -314173.65234375

 Scenario rail_schedule Algo rmappo Exp attempt updates 5/520 episodes, total num timesteps 11520/1000000.0, FPS 1753.

average episode rewards is -309914.23828125

 Scenario rail_schedule Algo rmappo Exp attempt updates 10/520 episodes, total num timesteps 21120/1000000.0, FPS 1697.

average episode rewards is -299815.25390625

 Scenario rail_schedule Algo rmappo Exp attempt updates 15/520 episodes, total num timesteps 30720/1000000.0, FPS 1651.

average episode rewards is -296738.583984375

 Scenario rail_schedule Algo rmappo Exp attempt updates 20/520 episodes, total num timesteps 40320/1000000.0, FPS 1639.

average episode rewards is -296152.763671875

 Scenario rail_schedule Algo rmappo Exp attempt updates 25/520 episodes, total num timesteps 49920/1000000.0, FPS 1655.

average episode rewards is -284013.046875

 Scenario rail_schedule Algo rmappo Exp attempt updates 30/520 episodes, total num timesteps 59520/1000000.0, FPS 1649.

average episode rewards is -287130.615234375

 Scenario rail_schedule Algo rmappo Exp attempt updates 35/520 episodes, total num timesteps 69120/1000000.0, FPS 1639.

average episode rewards is -293038.359375

 Scenario rail_schedule Algo rmappo Exp attempt updates 40/520 episodes, total num timesteps 78720/1000000.0, FPS 1628.

average episode rewards is -286243.916015625

 Scenario rail_schedule Algo rmappo Exp attempt updates 45/520 episodes, total num timesteps 88320/1000000.0, FPS 1612.

average episode rewards is -280517.255859375

 Scenario rail_schedule Algo rmappo Exp attempt updates 50/520 episodes, total num timesteps 97920/1000000.0, FPS 1603.

average episode rewards is -283682.197265625

 Scenario rail_schedule Algo rmappo Exp attempt updates 55/520 episodes, total num timesteps 107520/1000000.0, FPS 1601.

average episode rewards is -277812.01171875

 Scenario rail_schedule Algo rmappo Exp attempt updates 60/520 episodes, total num timesteps 117120/1000000.0, FPS 1609.

average episode rewards is -275660.44921875

 Scenario rail_schedule Algo rmappo Exp attempt updates 65/520 episodes, total num timesteps 126720/1000000.0, FPS 1597.

average episode rewards is -275312.841796875

 Scenario rail_schedule Algo rmappo Exp attempt updates 70/520 episodes, total num timesteps 136320/1000000.0, FPS 1596.

average episode rewards is -277818.076171875

 Scenario rail_schedule Algo rmappo Exp attempt updates 75/520 episodes, total num timesteps 145920/1000000.0, FPS 1592.

average episode rewards is -277058.90625

 Scenario rail_schedule Algo rmappo Exp attempt updates 80/520 episodes, total num timesteps 155520/1000000.0, FPS 1583.

average episode rewards is -278045.5078125

 Scenario rail_schedule Algo rmappo Exp attempt updates 85/520 episodes, total num timesteps 165120/1000000.0, FPS 1584.

average episode rewards is -277198.88671875

 Scenario rail_schedule Algo rmappo Exp attempt updates 90/520 episodes, total num timesteps 174720/1000000.0, FPS 1587.

average episode rewards is -277912.470703125

 Scenario rail_schedule Algo rmappo Exp attempt updates 95/520 episodes, total num timesteps 184320/1000000.0, FPS 1588.

average episode rewards is -276489.287109375

 Scenario rail_schedule Algo rmappo Exp attempt updates 100/520 episodes, total num timesteps 193920/1000000.0, FPS 1595.

average episode rewards is -276546.03515625

 Scenario rail_schedule Algo rmappo Exp attempt updates 105/520 episodes, total num timesteps 203520/1000000.0, FPS 1598.

average episode rewards is -276768.33984375

 Scenario rail_schedule Algo rmappo Exp attempt updates 110/520 episodes, total num timesteps 213120/1000000.0, FPS 1600.

average episode rewards is -276862.03125

 Scenario rail_schedule Algo rmappo Exp attempt updates 115/520 episodes, total num timesteps 222720/1000000.0, FPS 1602.

average episode rewards is -276538.154296875

 Scenario rail_schedule Algo rmappo Exp attempt updates 120/520 episodes, total num timesteps 232320/1000000.0, FPS 1598.

average episode rewards is -273746.865234375

 Scenario rail_schedule Algo rmappo Exp attempt updates 125/520 episodes, total num timesteps 241920/1000000.0, FPS 1602.

average episode rewards is -273050.5078125

 Scenario rail_schedule Algo rmappo Exp attempt updates 130/520 episodes, total num timesteps 251520/1000000.0, FPS 1604.

average episode rewards is -273759.697265625

 Scenario rail_schedule Algo rmappo Exp attempt updates 135/520 episodes, total num timesteps 261120/1000000.0, FPS 1603.

average episode rewards is -274659.31640625

 Scenario rail_schedule Algo rmappo Exp attempt updates 140/520 episodes, total num timesteps 270720/1000000.0, FPS 1606.

average episode rewards is -273165.791015625

 Scenario rail_schedule Algo rmappo Exp attempt updates 145/520 episodes, total num timesteps 280320/1000000.0, FPS 1605.

average episode rewards is -273016.552734375

 Scenario rail_schedule Algo rmappo Exp attempt updates 150/520 episodes, total num timesteps 289920/1000000.0, FPS 1605.

average episode rewards is -273990.263671875

 Scenario rail_schedule Algo rmappo Exp attempt updates 155/520 episodes, total num timesteps 299520/1000000.0, FPS 1609.

average episode rewards is -273505.4296875

 Scenario rail_schedule Algo rmappo Exp attempt updates 160/520 episodes, total num timesteps 309120/1000000.0, FPS 1610.

average episode rewards is -273567.71484375

 Scenario rail_schedule Algo rmappo Exp attempt updates 165/520 episodes, total num timesteps 318720/1000000.0, FPS 1611.

average episode rewards is -274581.2109375

 Scenario rail_schedule Algo rmappo Exp attempt updates 170/520 episodes, total num timesteps 328320/1000000.0, FPS 1612.

average episode rewards is -272698.388671875

 Scenario rail_schedule Algo rmappo Exp attempt updates 175/520 episodes, total num timesteps 337920/1000000.0, FPS 1614.

average episode rewards is -261659.47265625

 Scenario rail_schedule Algo rmappo Exp attempt updates 180/520 episodes, total num timesteps 347520/1000000.0, FPS 1613.

average episode rewards is -261838.271484375

 Scenario rail_schedule Algo rmappo Exp attempt updates 185/520 episodes, total num timesteps 357120/1000000.0, FPS 1615.

average episode rewards is -263680.4296875

 Scenario rail_schedule Algo rmappo Exp attempt updates 190/520 episodes, total num timesteps 366720/1000000.0, FPS 1618.

average episode rewards is -270355.283203125

 Scenario rail_schedule Algo rmappo Exp attempt updates 195/520 episodes, total num timesteps 376320/1000000.0, FPS 1618.

average episode rewards is -274149.287109375

 Scenario rail_schedule Algo rmappo Exp attempt updates 200/520 episodes, total num timesteps 385920/1000000.0, FPS 1619.

average episode rewards is -268790.09765625

 Scenario rail_schedule Algo rmappo Exp attempt updates 205/520 episodes, total num timesteps 395520/1000000.0, FPS 1623.

average episode rewards is -275897.98828125

 Scenario rail_schedule Algo rmappo Exp attempt updates 210/520 episodes, total num timesteps 405120/1000000.0, FPS 1622.

average episode rewards is -282091.025390625

 Scenario rail_schedule Algo rmappo Exp attempt updates 215/520 episodes, total num timesteps 414720/1000000.0, FPS 1622.

average episode rewards is -274116.240234375

 Scenario rail_schedule Algo rmappo Exp attempt updates 220/520 episodes, total num timesteps 424320/1000000.0, FPS 1624.

average episode rewards is -279144.4921875

 Scenario rail_schedule Algo rmappo Exp attempt updates 225/520 episodes, total num timesteps 433920/1000000.0, FPS 1625.

average episode rewards is -278139.78515625

 Scenario rail_schedule Algo rmappo Exp attempt updates 230/520 episodes, total num timesteps 443520/1000000.0, FPS 1624.

average episode rewards is -287379.90234375

 Scenario rail_schedule Algo rmappo Exp attempt updates 235/520 episodes, total num timesteps 453120/1000000.0, FPS 1624.

average episode rewards is -288154.86328125

 Scenario rail_schedule Algo rmappo Exp attempt updates 240/520 episodes, total num timesteps 462720/1000000.0, FPS 1630.

average episode rewards is -257183.115234375

 Scenario rail_schedule Algo rmappo Exp attempt updates 245/520 episodes, total num timesteps 472320/1000000.0, FPS 1630.

average episode rewards is -257711.748046875

 Scenario rail_schedule Algo rmappo Exp attempt updates 250/520 episodes, total num timesteps 481920/1000000.0, FPS 1631.

average episode rewards is -258770.44921875
Traceback (most recent call last):
  File "main.py", line 124, in <module>
    main(sys.argv[1:])
  File "main.py", line 109, in main
    runner.run()
  File "/home/chunhuili/Transportation/RailEnvironment/MAPPO/runner/rail_runner.py", line 27, in run
    values, actions, action_log_probs, rnn_states, rnn_states_critic, actions_env = self.collect(step)
  File "/home/chunhuili/anaconda3/envs/transport/lib/python3.8/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/chunhuili/Transportation/RailEnvironment/MAPPO/runner/rail_runner.py", line 107, in collect
    = self.trainer.policy.get_actions(step_share_obs, step_obs, step_rnn_states,step_rnn_states_critic, step_masks)
  File "/home/chunhuili/Transportation/RailEnvironment/MAPPO/algorithms/rMAPPOPolicy.py", line 68, in get_actions
    values, rnn_states_critic = self.critic(cent_obs, rnn_states_critic, masks)
  File "/home/chunhuili/anaconda3/envs/transport/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/chunhuili/anaconda3/envs/transport/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/chunhuili/Transportation/RailEnvironment/MAPPO/algorithms/r_actor_critic.py", line 172, in forward
    critic_features, rnn_states = self.rnn(critic_features, rnn_states, masks)
  File "/home/chunhuili/anaconda3/envs/transport/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/chunhuili/anaconda3/envs/transport/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/chunhuili/Transportation/RailEnvironment/MAPPO/algorithms/utils/rnn.py", line 26, in forward
    x, hxs = self.rnn(x.unsqueeze(0),
  File "/home/chunhuili/anaconda3/envs/transport/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/chunhuili/anaconda3/envs/transport/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/chunhuili/anaconda3/envs/transport/lib/python3.8/site-packages/torch/nn/modules/rnn.py", line 1139, in forward
    result = _VF.gru(input, hx, self._flat_weights, self.bias, self.num_layers,
KeyboardInterrupt
